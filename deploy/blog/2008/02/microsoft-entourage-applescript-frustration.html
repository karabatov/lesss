
<!DOCTYPE html>
<html>
    <head>
        <link href='http://fonts.googleapis.com/css?family=OFL+Sorts+Mill+Goudy+TT:regular,italic' rel='stylesheet' type='text/css' />
        <link rel="profile" href="http://microformats.org/profile/hcard" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />

        <title>Entourage + Applescript = Frustration / Steve Losh</title>

        
            <link href="http://feeds2.feedburner.com/stevelosh"
                  rel="alternate" title="Steve Losh"
                  type="application/atom+xml" />
        

        
            <link rel="stylesheet" href="/media/css/aal.css"      type="text/css" media="screen" charset="utf-8" />
            <link rel="stylesheet" href="/media/css/sjl.css"      type="text/css" media="screen" charset="utf-8" />
            <link rel="stylesheet" href="/media/css/print.css"    type="text/css" media="print" charset="utf-8" />
            
    <link rel="stylesheet"
          href="/media/css/pygments-monokai-light.css"
          type="text/css" media="screen" charset="utf-8" />

        

        
            <script src="/media/js/jquery.js" type="text/javascript"></script>
            <script src="/media/js/jquery.timeago.js" type="text/javascript"></script>
            <script src="/media/js/sjl.js" type="text/javascript"></script>
            <script src="/media/js/print.js" type="text/javascript"></script>

            <script type="text/javascript">
                $(function() {
                    $("a.rhythm").toggle(function() {
                        $("body").addClass("rhythm");
                    }, function() {
                        $("body").removeClass("rhythm");
                    });
                });
            </script>

            <script type="text/javascript">
            /* <![CDATA[ */
                (function() {
                    var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];

                    s.type = 'text/javascript';
                    s.async = true;
                    s.src = 'http://api.flattr.com/js/0.5.0/load.js?mode=auto';

                    t.parentNode.insertBefore(s, t);
                })();
            /* ]]> */
            </script>

            
        

        <link rel="openid.server" href="http://www.myopenid.com/server" />
        <link rel="openid.delegate" href="http://stevelosh.myopenid.com/" />

        <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-15328874-2']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>

    </head>

    <body>
        <div class="wrap">
            <div class="top group">
                <header>
                    <a href="/">steve losh</a>
                </header>

                <nav>
                    <a href="/blog/">Blog</a>
                    <span class="sep">-</span>
                    <a href="/projects">Projects</a>
                    <span class="sep">-</span>
                    <a href="/about/">About</a>
                    <span class="sep">-</span>
                    <a href="http://feeds2.feedburner.com/stevelosh">Feed</a>
                </nav>
            </div>

            <div class="hr">&nbsp;</div>

            <div class="content">
                
                    
                        
    <div id="leaf-title">
        <h1><a href="/blog/2008/02/microsoft-entourage-applescript-frustration/">Entourage + Applescript =&nbsp;Frustration</a></h1>
    </div>


    <div id="leaf-stats" class="group">
        
            <div class="flattr">
                <a class="FlattrButton" style="display:none;" rev="flattr;button:compact;"
                   href="http://stevelosh.com/blog/2008/02/microsoft-entourage-applescript-frustration/"></a>
           </div>
        
        <p>
            Posted
            <span class="timeago"
                  title="2008-02-21T15:25:45">
            </span>
            on February 21, 2008.
        </p>
    </div>

    <div id="leaf-content" class="">
        
            <!-- Hyde::Article::Begin -->
                
                    <p>I&#8217;ve been working on a project lately to automate the setup of some rules and
schedules in Microsoft Entourage. This isn&#8217;t the easiest thing in the world
because Entourage doesn&#8217;t really support AppleScript for creating rules or
schedules (though it does an admirable job in a lot of&nbsp;other&nbsp;areas).</p>
<p>We&#8217;ve resorted to <span class="caps"><span class="caps">GUI</span></span> scripting to get the job done. This basically means
we&#8217;re telling our script to click button X, wait a bit, put &#8220;abc&#8221; in text
field Y, click button Z, etc. This is painful, fragile and slow but it does
what we need in all but&nbsp;one&nbsp;case.</p>
<p>That case is selecting a folder. The folder list dialog that pops up doesn&#8217;t
seem to use any of Apple&#8217;s <span class="caps"><span class="caps">UI</span></span> components which makes <span class="caps"><span class="caps">GUI</span></span> scripting it nearly
impossible. Only &#8220;nearly&#8221; though, because there&#8217;s a way to get around it: the
keyboard. AppleScript can type into a window by sending a series of key codes.
You can select something from the folder list by typing its name, which means
that as long as you know the name (we do) you can select&nbsp;it.&nbsp;Almost.</p>
<p>There&#8217;s one more snag: selection by typing will only ever select the first
item in the list. This means that if you want to select &#8220;Inbox&#8221; and both the
&#8220;On My Computer&#8221; list and the &#8220;youremail@server.com&#8221; list are open, you can
only get the first Inbox. Oh, and good luck predicting which one will show up
first. It seemed to be different each time I opened&nbsp;the&nbsp;window.</p>
<p>Once again the keyboard comes to our rescue. A simple (and excruciatingly
ugly) fix is to make sure that the only account listing that&#8217;s open is the one
we want. How can we do that? Send an up arrow key code 50 times to move to the
beginning of the list, then left and down codes 50 times. This collapses the
entire tree. Then just type the name of the account to select it, send the
right arrow code to expand the tree, and type the folder name to&nbsp;select&nbsp;it.</p>
<p>It&#8217;s painful, but it works. If anyone has a better solution please let me know
so I can rip this monstrosity out of my code and try to forget&nbsp;about&nbsp;it.</p>
                
            <!-- Hyde::Article::End -->
        
    </div>

                    
                
            </div>

            <div class="hrb">&nbsp;</div>

            <footer>
                I'm also on
                <a href="http://bitbucket.org/sjl/">BitBucket</a>,
                <a href="http://github.com/sjl/">GitHub</a>,
                <a href="http://twitter.com/stevelosh/">Twitter</a>,
                <a href="http://forrst.com/people/stevelosh/">Forrst</a>
                and
                <a href="http://flickr.com/photos/sjl7678/">Flickr</a>.
                I've got <a href="#" class="rhythm">rhythm</a>.
            </footer>
        </div>
    </body>

    <script type="text/javascript">
        var _gauges = _gauges || [];
        (function() {
         var t   = document.createElement('script');
         t.type  = 'text/javascript';
         t.async = true;
         t.id    = 'gauges-tracker';
         t.setAttribute('data-site-id', '4e8f83a7f5a1f53f20000011');
         t.src = '//secure.gaug.es/track.js';
         var s = document.getElementsByTagName('script')[0];
         s.parentNode.insertBefore(t, s);
         })();
     </script>
</html>
